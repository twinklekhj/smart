<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="book">
    <!-- [조회] 추천 도서 목록 조회 -->
    <select id="getBookList" parameterType="map" resultType="io.github.twinklekhj.smart.dao.entity.Book">
        SELECT
            id
            ,title
            ,author
            ,publisher
            ,isbn
            ,image_url
        FROM tbl_book
        <where>
            <if test="title != null and title != ''">
                AND title LIKE '%' || #{title} || '%'
            </if>
            <if test="author != null and author != ''">
                AND author LIKE '%' || #{author} || '%'
            </if>
            <if test="publisher != null and publisher != ''">
                AND publisher LIKE '%' || #{publisher} || '%'
            </if>
        </where>
        ORDER BY create_date DESC
        <if test='pageIdx != null and pageSize != null'>
            OFFSET ((${pageIdx} * ${pageSize}) - ${pageSize}) ROWS FETCH NEXT ${pageSize} ROWS ONLY
        </if>
    </select>

    <select id="getBookInfo" parameterType="long" resultType="io.github.twinklekhj.smart.dao.entity.Book">
        SELECT
        id
        ,title
        ,author
        ,publisher
        ,isbn
        ,image_url
        FROM tbl_book
        WHERE id = #{id}
    </select>
</mapper>